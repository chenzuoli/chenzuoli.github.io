<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="msvalidate.01" content="F129FD2F3DAF3B4E8D4BB73786E3655C"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/fourleafclover-32x32.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/fourleafclover-16x16.png?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="oracle,postgresql,实时同步,mysql,mongo,sql server,"><link rel="alternate" href="/atom.xml" title="chenzuoli's blog" type="application/atom+xml"><meta name="description" content="给大家介绍一个实时同步数据库的组件debezium，它可以同步mysql、postgresql、mongo、oracle、sql server数据库到hdfs、kafka，功能强大，具体如下。"><meta property="og:type" content="article"><meta property="og:title" content="debezium实时同步mysql、postgresql数据介绍"><meta property="og:url" content="https://chenzuoli.github.io/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/index.html"><meta property="og:site_name" content="chenzuoli&#39;s blog"><meta property="og:description" content="给大家介绍一个实时同步数据库的组件debezium，它可以同步mysql、postgresql、mongo、oracle、sql server数据库到hdfs、kafka，功能强大，具体如下。"><meta property="og:locale"><meta property="og:image" content="https://chenzuoli.github.io/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/5DCA7786FF43D058BBB827BC521EFBDE"><meta property="og:image" content="https://chenzuoli.github.io/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/A91E335CC16D805E66B44CD76ADF4383"><meta property="og:image" content="https://chenzuoli.github.io/images/%E7%A8%8B%E5%BA%8F%E5%91%98%E5%86%99%E4%B9%A6%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BA%8C%E7%BB%B4%E7%A0%81.jpg"><meta property="og:image" content="https://chenzuoli.github.io/images/%E7%94%B5%E5%B7%B4%E5%85%8B%E5%AE%A0%E7%89%A9Pets%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BA%8C%E7%BB%B4%E7%A0%81.png"><meta property="article:published_time" content="2019-07-20T03:01:09.000Z"><meta property="article:modified_time" content="2019-07-20T03:01:09.000Z"><meta property="article:author" content="Lee"><meta property="article:tag" content="oracle"><meta property="article:tag" content="postgresql"><meta property="article:tag" content="实时同步"><meta property="article:tag" content="mysql"><meta property="article:tag" content="mongo"><meta property="article:tag" content="sql server"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://chenzuoli.github.io/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/5DCA7786FF43D058BBB827BC521EFBDE"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"",scheme:"Mist",version:"5.1.3",sidebar:{position:"right",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://chenzuoli.github.io/2019/07/20/debezium实时同步mysql、postgresql数据介绍/"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6592717531467819",enable_page_level_ads:!0})</script><script data-ad-client="ca-pub-6592717531467819" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.5.2/animate.min.css"><script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script><style>.floating-card-right{position:fixed;bottom:12%;right:10px;width:200px;z-index:9999}</style><div class="floating-card-right animate__animated animate__fadeInRight"><a href="https://lezhifu.cc" target="_blank"><div class="card"><div class="card-content"><span class="card-title">乐知付加密服务平台</span><p>如果你有资源， 平台可以帮你实现内容变现， 无需搭建知识付费服务平台。</p></div><div class="card-action text-left"><a href="https://lezhifu.cc" target="_blank">点击访问官方网站</a> <span>https://lezhifu.cc</span></div><br><div class="card-action text-center"><span>扫码关注公众号</span> <img width="50%" height="50%" src="/images/qrcode_lezhifu.jpg" alt="乐知付加密服务平台-微信公众号"></div></div></a></div><title>debezium实时同步mysql、postgresql数据介绍 | chenzuoli's blog</title><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-right page-post-detail"><div class="headband"></div><a target="_blank" rel="noopener" href="https://github.com/chenzuoli" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64ceaa;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">chenzuoli's blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Focus on truth. welcome to correct.</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-top"><a href="/top/" rel="section"><i class="menu-item-icon fa fa-fw fa-signal"></i><br>阅读排行</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-question-circle"></i><br>RSS</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://chenzuoli.github.io/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="chenzuoli's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">debezium实时同步mysql、postgresql数据介绍</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-20T11:01:09+08:00">2019-07-20 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于&#58;</span> <time title="更新于" itemprop="dateModified" datetime="2019-07-20T11:01:09+08:00">2019-07-20 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span> </a></span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据仓库</span> </a></span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/CDC/" itemprop="url" rel="index"><span itemprop="name">CDC</span> </a></span></span><span id="/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/" class="leancloud_visitors" data-flag-title="debezium实时同步mysql、postgresql数据介绍"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数&#58;</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-divider">|</span> <span class="page-pv"><i class="fa fa-file-o"></i> 浏览量 <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>给大家介绍一个实时同步数据库的组件debezium，它可以同步mysql、postgresql、mongo、oracle、sql server数据库到hdfs、kafka，功能强大，具体如下。</p><span id="more"></span><p>大致安装步骤：</p><ol><li>插件decoderbufs或者wal2json</li><li>postgresql配置logical等</li><li>confluent平台搭建</li><li>配置connector</li></ol><p>参考文档：<a target="_blank" rel="noopener" href="https://debezium.io/docs/connectors/">https://debezium.io/docs/connectors/</a></p><h1>for postgresql to kafka</h1><p><b>核心：一个active slot，多个connector</b></p><h2 id="1-bin-x2F-connect-distributed-etc-x2F-kafka-x2F-connect-distributed-properties"><a href="#1-bin-x2F-connect-distributed-etc-x2F-kafka-x2F-connect-distributed-properties" class="headerlink" title="1. bin&#x2F;connect-distributed etc&#x2F;kafka&#x2F;connect-distributed.properties"></a>1. bin&#x2F;connect-distributed etc&#x2F;kafka&#x2F;connect-distributed.properties</h2><p>三台服务器分别执行启动distributed服务（相同的slot.name、group.id保证复制同一个slot replication，保证在同一个组内）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin/connect-distributed etc/kafka/connect-distributed-8084.properties</span><br><span class="line">bin/connect-distributed etc/kafka/connect-distributed-8085.properties</span><br><span class="line">bin/connect-distributed etc/kafka/connect-distributed-8086.properties</span><br></pre></td></tr></table></figure><h2 id="2-bin-x2F-connect-standalone-etc-x2F-kafka-x2F-connect-standalone-properties-etc-x2F-kafka-connect-postgres-x2F-debezium-properties"><a href="#2-bin-x2F-connect-standalone-etc-x2F-kafka-x2F-connect-standalone-properties-etc-x2F-kafka-connect-postgres-x2F-debezium-properties" class="headerlink" title="2. bin&#x2F;connect-standalone etc&#x2F;kafka&#x2F;connect-standalone.properties etc&#x2F;kafka-connect-postgres&#x2F;debezium.properties"></a>2. bin&#x2F;connect-standalone etc&#x2F;kafka&#x2F;connect-standalone.properties etc&#x2F;kafka-connect-postgres&#x2F;debezium.properties</h2><p>bin&#x2F;kafka-console-consumer –zookeeper localhost:2182 –topic postgres.localhost.public.test –from-beginning</p><h2 id="3-安装decoderbufs、wal2json-plugin"><a href="#3-安装decoderbufs、wal2json-plugin" class="headerlink" title="3. 安装decoderbufs、wal2json plugin"></a>3. 安装decoderbufs、wal2json plugin</h2><p><a target="_blank" rel="noopener" href="https://github.com/debezium/postgres-decoderbufs/blob/master/README.md">https://github.com/debezium/postgres-decoderbufs/blob/master/README.md</a><br><a target="_blank" rel="noopener" href="https://github.com/eulerto/wal2json/blob/master/README.md">https://github.com/eulerto/wal2json/blob/master/README.md</a></p><p>安装wal2json时出现的问题：Makefile:10: &#x2F;usr&#x2F;lib64&#x2F;pgsql&#x2F;pgxs&#x2F;src&#x2F;makefiles&#x2F;pgxs.mk: No such file or directory<br>yum install postgresql10-devel即可</p><h2 id="4-配置"><a href="#4-配置" class="headerlink" title="4. 配置"></a>4. 配置</h2><p>参考文档：<a target="_blank" rel="noopener" href="https://zhubingxu.me/2018/06/05/debezium-postgres/">https://zhubingxu.me/2018/06/05/debezium-postgres/</a></p><p>share&#x2F;java&#x2F;下创建debezium文件夹，创建文件debezium.properties：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">name=events-debezium</span><br><span class="line">tasks.max=1</span><br><span class="line">connector.class=io.debezium.connector.postgresql.PostgresConnector</span><br><span class="line">database.hostname=localhost</span><br><span class="line">database.port=5432</span><br><span class="line">database.user=postgres</span><br><span class="line">database.password=postgres</span><br><span class="line">database.dbname=postgres</span><br><span class="line">database.history.kafka.bootstrap.servers=localhost:9092</span><br><span class="line">database.server.id=1</span><br><span class="line">database.server.name=postgres.localhost</span><br><span class="line">plugin.name=wal2json</span><br><span class="line">include.schema.changes=true</span><br><span class="line">slot.name=my\_slot\_name</span><br></pre></td></tr></table></figure><h2 id="5-异常"><a href="#5-异常" class="headerlink" title="5. 异常"></a>5. 异常</h2><p>Error while fetching metadata with correlation id 1 : {postgres.localhost.public.test&#x3D;LEADER_NOT_AVAILABLE}</p><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/35788697/leader-not-available-kafka-in-console-producer">https://stackoverflow.com/questions/35788697/leader-not-available-kafka-in-console-producer</a></p><p>配置debezium中$DEBEZIUM_HOME&#x2F;etc&#x2F;kafka&#x2F;server.properties</p><p>指定参数advertised.host.name</p><p>ERROR A logical replication slot named ‘debezium’ for plugin ‘wal2json’ and database ‘postgres’ is already active on the server.You cannot have multiple slots with the same name active for the same database (io.debezium.connector.postgresql.connection.PostgresReplicationConnection:104)</p><p>在创建connector的配置参数中添加新的slot.name，slot.name的规范必须为字母数字下划线。不指定的话默认为debezium，会产生冲突。</p><h2 id="6-分布式kafka-connector配置："><a href="#6-分布式kafka-connector配置：" class="headerlink" title="6. 分布式kafka connector配置："></a>6. 分布式kafka connector配置：</h2><p><a target="_blank" rel="noopener" href="https://archive.cloudera.com/kafka/kafka/2/kafka-0.9.0-kafka2.0.1/connect.html">https://archive.cloudera.com/kafka/kafka/2/kafka-0.9.0-kafka2.0.1/connect.html</a>分布式connector需要通过rest api进行增删改</p><p><a target="_blank" rel="noopener" href="https://mapr.com/docs/52/Kafka/Connect-distributed-mode.html">https://mapr.com/docs/52/Kafka/Connect-distributed-mode.html</a> connect-distributed.properties</p><p>连接参数配置：<a target="_blank" rel="noopener" href="https://debezium.io/docs/connectors/postgresql/#connector-properties">https://debezium.io/docs/connectors/postgresql/#connector-properties</a></p><h2 id="7-注意："><a href="#7-注意：" class="headerlink" title="7. 注意："></a>7. 注意：</h2><p>table.whitelist格式：schemaName.tblname</p><p>如果启动connector出现权限不足时：需要给用户赋update权限：</p><p>GRANT SELECT, UPDATE ON TABLE test TO debezium;</p><p>不监控无主键的表</p><h2 id="8-查看postgresql-slot"><a href="#8-查看postgresql-slot" class="headerlink" title="8. 查看postgresql slot"></a>8. 查看postgresql slot</h2><p>a.登陆：psql -U user -d db -h host -p port -W<br>b.查看所有slot： select * from pg_replication_slots;<br>c.添加slot：SELECT * FROM pg_create_physical_replication_slot(‘pg96_102’);<br>d.删除slot：SELECT * FROM pg_drop_replication_slot(‘pg96_102’);</p><br><br><h1>for mysql to kafka</h1><p>核心：启动多个connector即可</p><h2 id="1-账户及权限"><a href="#1-账户及权限" class="headerlink" title="1. 账户及权限"></a>1. 账户及权限</h2><p>mysql user: debezium:*******</p><p>GRANT SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO ‘debezium’ IDENTIFIED BY ‘******‘;</p><h2 id="2-配置"><a href="#2-配置" class="headerlink" title="2. 配置"></a>2. 配置</h2><p><a target="_blank" rel="noopener" href="https://debezium.io/docs/connectors/mysql/#setting-up-mysql">https://debezium.io/docs/connectors/mysql/#setting-up-mysql</a></p><h2 id="3-启动"><a href="#3-启动" class="headerlink" title="3. 启动"></a>3. 启动</h2><p>bin&#x2F;connect-standalone etc&#x2F;kafka&#x2F;connect-standalone.properties share&#x2F;java&#x2F;debezium&#x2F;mysql-debezium-8087.properties</p><p>三台服务器分别运行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin/connect-distributed etc/kafka/mysql-connect-distributed-8134.properties</span><br><span class="line">bin/connect-distributed etc/kafka/mysql-connect-distributed-8134.properties</span><br><span class="line">bin/connect-distributed etc/kafka/mysql-connect-distributed-8134.properties</span><br></pre></td></tr></table></figure><h2 id="4-kafka-connector"><a href="#4-kafka-connector" class="headerlink" title="4. kafka connector"></a>4. kafka connector</h2><p>请求添加connector-task，随便在哪一台服务器添加1个task</p><p>curl -X POST -H “Content-Type: application&#x2F;json” –data @share&#x2F;java&#x2F;debezium&#x2F;mysql-8134.json <a target="_blank" rel="noopener" href="http://localhost:8134/connectors">http://localhost:8134/connectors</a></p><p>table.whitelist格式：dbname.tblname</p><p>测试环境test-hadoop：&#x2F;mnt&#x2F;confluent下<br>生成的topic名称为：servername.dbname.tblname</p><h2 id="5-异常（未解决）"><a href="#5-异常（未解决）" class="headerlink" title="5. 异常（未解决）"></a>5. 异常（未解决）</h2><p><img src="/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/5DCA7786FF43D058BBB827BC521EFBDE" alt="1"><br><img src="/2019/07/20/debezium%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5mysql%E3%80%81postgresql%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D/A91E335CC16D805E66B44CD76ADF4383" alt="2"></p><h2 id="如果有解决方案，请联系我邮箱-99-104-x65-110-x7a-117-x6f-x6c-105-55-x30-57-64-49-54-x33-46-x63-x6f-109-，不胜感激。"><a href="#如果有解决方案，请联系我邮箱-99-104-x65-110-x7a-117-x6f-x6c-105-55-x30-57-64-49-54-x33-46-x63-x6f-109-，不胜感激。" class="headerlink" title="如果有解决方案，请联系我邮箱&#99;&#104;&#x65;&#110;&#x7a;&#117;&#x6f;&#x6c;&#105;&#55;&#x30;&#57;&#64;&#49;&#54;&#x33;&#46;&#x63;&#x6f;&#109;，不胜感激。"></a><b>如果有解决方案，请联系我邮箱<a href="mailto:&#99;&#104;&#x65;&#110;&#x7a;&#117;&#x6f;&#x6c;&#105;&#55;&#x30;&#57;&#64;&#49;&#54;&#x33;&#46;&#x63;&#x6f;&#109;">&#99;&#104;&#x65;&#110;&#x7a;&#117;&#x6f;&#x6c;&#105;&#55;&#x30;&#57;&#64;&#49;&#54;&#x33;&#46;&#x63;&#x6f;&#109;</a>，不胜感激。</b></h2><p><b>书山有路勤为径，学海无涯苦作舟。</b></p><p>欢迎关注微信公众号：【程序员写书】<br><img src="/images/%E7%A8%8B%E5%BA%8F%E5%91%98%E5%86%99%E4%B9%A6%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BA%8C%E7%BB%B4%E7%A0%81.jpg" alt="程序员写书"></p><p>喜欢宠物的朋友可以关注：【电巴克宠物Pets】<br><img src="/images/%E7%94%B5%E5%B7%B4%E5%85%8B%E5%AE%A0%E7%89%A9Pets%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BA%8C%E7%BB%B4%E7%A0%81.png" alt="电巴克宠物"></p><p>一起学习，一起进步。<br></p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6592717531467819",enable_page_level_ads:!0})</script><script data-ad-client="ca-pub-6592717531467819" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/oracle/" rel="tag"><i class="fa fa-tag"></i> oracle</a> <a href="/tags/postgresql/" rel="tag"><i class="fa fa-tag"></i> postgresql</a> <a href="/tags/%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/" rel="tag"><i class="fa fa-tag"></i> 实时同步</a> <a href="/tags/mysql/" rel="tag"><i class="fa fa-tag"></i> mysql</a> <a href="/tags/mongo/" rel="tag"><i class="fa fa-tag"></i> mongo</a> <a href="/tags/sql-server/" rel="tag"><i class="fa fa-tag"></i> sql server</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/07/07/%E8%8B%B1%E5%9B%BD%E6%9E%84%E6%88%90%E5%9B%BD/" rel="next" title="英国构成国"><i class="fa fa-chevron-left"></i> 英国构成国</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2019/07/21/hive%E7%9B%B8%E5%85%B3/" rel="prev" title="hive相关">hive相关 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="bdsharebuttonbox"><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a> <a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a> <a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a> <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a> <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a> <a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a> <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a> <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a> <a href="#" class="bds_more" data-cmd="more"></a> <a class="bds_count" data-cmd="count"></a></div><script>window._bd_share_config={common:{bdText:"",bdMini:"2",bdMiniList:!1,bdPic:""},share:{bdSize:"16",bdStyle:"0"},image:{viewList:["tsina","douban","sqq","qzone","weixin","twi","fbook"],viewText:"分享到：",viewSize:"16"}}</script><script>with(document)(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="//bdimg.share.baidu.com/static/api/js/share.js?cdnversion="+~(-new Date/36e5)</script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name"></p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">479</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">238</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">528</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/chenzuoli" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:chenzuoli709@163.com" target="_blank" title="G-Mail"><i class="fa fa-fw fa-envelope"></i>G-Mail</a> </span><span class="links-of-author-item"><a href="https://plus.google.com/107350128873508779089" target="_blank" title="Google"><i class="fa fa-fw fa-google"></i>Google</a> </span><span class="links-of-author-item"><a href="https://twitter.com/chenzuoli709" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i>Twitter</a> </span><span class="links-of-author-item"><a href="https://weibo.com/3255051645/profile?rightmod=1&wvr=6&mod=personinfo" target="_blank" title="Sina"><i class="fa fa-fw fa-weibo"></i>Sina</a> </span><span class="links-of-author-item"><a href="https://www.facebook.com/zuoli.chen.58" target="_blank" title="FB"><i class="fa fa-fw fa-facebook"></i>FB</a> </span><span class="links-of-author-item"><a href="https://blog.csdn.net/chenzuoli" target="_blank" title="CSDN"><i class="fa fa-fw fa-csdn"></i>CSDN</a> </span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/nihaoshijie709918" target="_blank" title="ZhiHu"><i class="fa fa-fw fa-zhihu"></i>ZhiHu</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">for postgresql to kafka</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-bin-x2F-connect-distributed-etc-x2F-kafka-x2F-connect-distributed-properties"><span class="nav-number">1.1.</span> <span class="nav-text">1. bin&#x2F;connect-distributed etc&#x2F;kafka&#x2F;connect-distributed.properties</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-bin-x2F-connect-standalone-etc-x2F-kafka-x2F-connect-standalone-properties-etc-x2F-kafka-connect-postgres-x2F-debezium-properties"><span class="nav-number">1.2.</span> <span class="nav-text">2. bin&#x2F;connect-standalone etc&#x2F;kafka&#x2F;connect-standalone.properties etc&#x2F;kafka-connect-postgres&#x2F;debezium.properties</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%AE%89%E8%A3%85decoderbufs%E3%80%81wal2json-plugin"><span class="nav-number">1.3.</span> <span class="nav-text">3. 安装decoderbufs、wal2json plugin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E9%85%8D%E7%BD%AE"><span class="nav-number">1.4.</span> <span class="nav-text">4. 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%BC%82%E5%B8%B8"><span class="nav-number">1.5.</span> <span class="nav-text">5. 异常</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%88%86%E5%B8%83%E5%BC%8Fkafka-connector%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="nav-number">1.6.</span> <span class="nav-text">6. 分布式kafka connector配置：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E6%B3%A8%E6%84%8F%EF%BC%9A"><span class="nav-number">1.7.</span> <span class="nav-text">7. 注意：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%9F%A5%E7%9C%8Bpostgresql-slot"><span class="nav-number">1.8.</span> <span class="nav-text">8. 查看postgresql slot</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">for mysql to kafka</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E8%B4%A6%E6%88%B7%E5%8F%8A%E6%9D%83%E9%99%90"><span class="nav-number">2.1.</span> <span class="nav-text">1. 账户及权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AE"><span class="nav-number">2.2.</span> <span class="nav-text">2. 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%90%AF%E5%8A%A8"><span class="nav-number">2.3.</span> <span class="nav-text">3. 启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-kafka-connector"><span class="nav-number">2.4.</span> <span class="nav-text">4. kafka connector</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%BC%82%E5%B8%B8%EF%BC%88%E6%9C%AA%E8%A7%A3%E5%86%B3%EF%BC%89"><span class="nav-number">2.5.</span> <span class="nav-text">5. 异常（未解决）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E6%9E%9C%E6%9C%89%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%8C%E8%AF%B7%E8%81%94%E7%B3%BB%E6%88%91%E9%82%AE%E7%AE%B1-99-104-x65-110-x7a-117-x6f-x6c-105-55-x30-57-64-49-54-x33-46-x63-x6f-109-%EF%BC%8C%E4%B8%8D%E8%83%9C%E6%84%9F%E6%BF%80%E3%80%82"><span class="nav-number">2.6.</span> <span class="nav-text">如果有解决方案，请联系我邮箱chenzuoli709@163.com，不胜感激。</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright" style="text-align:center">&copy; 2017 &mdash; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">petcage</span> <a target="_blank" rel="noopener" href="http://www.miitbeian.gov.cn/">&nbsp;&nbsp;&nbsp;&nbsp;京ICP备18009781号</a></div><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <span id="links1">&nbsp;&nbsp;&nbsp;<a target="_blank" rel="noopener" href="http://lezhifu.cc">乐知付加密平台</a></span><script>var now=new Date;function createtime(){var n=new Date("12/19/2017 13:14:21");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已安全运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i> 访问人数 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="site-pv"><i class="fa fa-eye"></i> 浏览次数 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="search.xml",path=(0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1),"/"+search_path),onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,s,a){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");function e(){var e,m=n.value.trim().toLowerCase(),x=m.split(/[\s\-]+/),w=(1<x.length&&x.push(m),[]);0<m.length&&o.forEach(function(t){var e=!1,o=0,h=0,n=t.title.trim(),r=n.toLowerCase(),s=t.content.trim().replace(/<[^>]+>/g,""),a=s.toLowerCase(),i=decodeURIComponent(t.url),c=[],l=[];if(""!=n&&(x.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r,s=0,a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());-1<(r=e.indexOf(t,s));)a.push({position:r,word:t}),s=r+n;return a}c=c.concat(e(t,r,!1)),l=l.concat(e(t,a,!1))}),0<c.length||0<l.length)&&(e=!0,o=c.length+l.length),e){function p(t,e,o,n){for(var r=n[n.length-1],s=r.position,a=r.word,i=[],c=0;s+a.length<=o&&0!=n.length;){a===m&&c++,i.push({position:s,length:a.length});var l=s+a.length;for(n.pop();0!=n.length&&(s=(r=n[n.length-1]).position,a=r.word,s<l);)n.pop()}return h+=c,{hits:i,start:e,end:o,searchTextCount:c}}[c,l].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});for(var t=[],u=(0!=c.length&&t.push(p(0,0,n.length,c)),[]);0!=l.length;){var f=l[l.length-1],d=f.position,f=f.word,g=d-20,v=d+80;g<0&&(g=0),(v=v<d+f.length?d+f.length:v)>s.length&&(v=s.length),u.push(p(0,g,v,l))}u.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});e=parseInt("1");function $(o,t){var n="",r=t.start;return t.hits.forEach(function(t){n+=o.substring(r,t.position);var e=t.position+t.length;n+='<b class="search-keyword">'+o.substring(t.position,e)+"</b>",r=e}),n+=o.substring(r,t.end)}0<=e&&(u=u.slice(0,e));var C="";C+=0!=t.length?"<li><a href='"+i+"' class='search-result-title'>"+$(n,t[0])+"</a>":"<li><a href='"+i+"' class='search-result-title'>"+n+"</a>",u.forEach(function(t){C+="<a href='"+i+'\'><p class="search-result">'+$(s,t)+"...</p></a>"}),C+="</li>",w.push({item:C,searchTextCount:h,hitCount:o,id:w.length})}}),1===x.length&&""===x[0]?r.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>':0===w.length?r.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>':(w.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id}),e='<ul class="search-result-list">',w.forEach(function(t){e+=t.item}),e+="</ul>",r.innerHTML=e)}var o=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,n=document.getElementById(s),r=document.getElementById(a);n.addEventListener("input",e),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("YJgpFR6aBjuB1wPKjFFRp443-MdYXbMMI","r8fnn6zRKLkDw1iaEe8g3qwb")</script><script>function showTime(e){var e=new AV.Query(e),l=[],c=$(".leancloud_visitors");c.each(function(){l.push($(this).attr("id").trim())}),e.containedIn("url",l),e.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)c.find(t).text(0);else{for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),o=o.get("time"),s=document.getElementById(i);$(s).find(t).text(o)}for(n=0;n<l.length;n++){var i=l[n],s=document.getElementById(i),r=$(s).find(t);""==r.text()&&r.text(0)}}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(n){var e=$(".leancloud_visitors"),o=e.attr("id").trim(),i=e.attr("data-flag-title").trim(),e=new AV.Query(n);e.equalTo("url",o),e.find({success:function(e){var t;0<e.length?((e=e[0]).fetchWhenSave(!0),e.increment("time"),e.save(null,{success:function(e){$(document.getElementById(o)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})):(e=new n,(t=new AV.ACL).setPublicReadAccess(!0),t.setPublicWriteAccess(!0),e.setACL(t),e.set("title",i),e.set("url",o),e.set("time",1),e.save(null,{success:function(e){$(document.getElementById(o)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}}))},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0],e=(t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}()</script><script type="text/javascript" src="/js/src/love.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("YJgpFR6aBjuB1wPKjFFRp443-MdYXbMMI","r8fnn6zRKLkDw1iaEe8g3qwb")</script><script>function showTime(e){var t=new AV.Query(e);$(".leancloud_visitors").each(function(){var o=$(this).attr("id").trim();t.equalTo("url",o),t.find({success:function(e){if(0==e.length)n="0 "+$(document.getElementById(o)).text(),$(document.getElementById(o)).text(n);else for(var t=0;t<e.length;t++){var n=e[t].get("time")+" "+$(document.getElementById(o)).text();$(document.getElementById(o)).text(n)}},error:function(e,t){console.log("Error: "+t.code+" "+t.message)}})})}function addCount(t){var t=AV.Object.extend("Counter"),e=(url=$(".leancloud_visitors").attr("id").trim(),title=$(".leancloud_visitors").attr("data-flag-title").trim(),new AV.Query(t));e.equalTo("url",url),e.find({success:function(e){0<e.length?((e=e[0]).fetchWhenSave(!0),e.increment("time"),e.save(null,{success:function(e){e=e.get("time")+" "+$(document.getElementById(url)).text();$(document.getElementById(url)).text(e)},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})):((e=new t).set("title",title),e.set("url",url),e.set("time",1),e.save(null,{success:function(e){console.log("newcounter.get('time')="+e.get("time"));e=e.get("time")+" "+$(document.getElementById(url)).text();$(document.getElementById(url)).text(e)},error:function(e,t){console.log("Failed to create")}}))},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},react:{opacity:.7}})</script></body></html>